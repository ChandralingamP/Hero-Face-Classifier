from flask import Flask, jsonify, request
from models import classify_image
from flask_restx import Api, Resource, fields
from flask_cors import CORS
app = Flask(__name__)
api = Api(app, doc='/docs')
CORS(app)
__imageData = None

result_model = api.model(
    "Result",{
        "result": fields.Integer()
    }
)

@api.route("/hello")
class HelloResource(Resource):
    def get(self):
        return {"message":"hello"}

@api.route("/classifier")
class Classifier(Resource):
    def get(self):
        global __imageData
        response = jsonify(classify_image(__imageData))
        response.headers.add('Access-Control-Allow-Origin', '*')
        return response
        # response = jsonify(classify_image("data:image/jpeg;base64,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"))
        # print(response)
        # return response

    def post(self):
        global __imageData
        __imageData = request.get_json()





if __name__ == "__main__":
    app.run(debug=True, port=5000)


